---
title: "Navigating an R Upgrade"
date: "`r Sys.Date()`"
output:
  html_document:
    mathjax: null
    jquery: null
    smart: no
---
  
```{r setup, echo=FALSE, results='hide', warning=FALSE}
library(knitr, quietly=TRUE)
opts_chunk$set(message=FALSE, warning=FALSE, background='#F7F7F7', fig.retina=2, dev='png', tidy=FALSE, verbose=FALSE)
options(width=100, stringsAsFactors=FALSE)
```


# Introduction
Occasionally our IT staff push a new version of **R** and **RStudio** to our local machines. This is usually a *good thing* as the more recent version contains bug-fixes and optimization. However, the library of R packages is "lost". This document outlines a couple of steps that you can take before and after the upgrade to minimize the inconvenience. Unlike previous updates we are hoping to provide NRCS staff with an warning before the new version is pushed out by IT.

# R Packages

Re-building the library of R packages can be time consuming if your network connection is slow. Consider doing this during a lunch break or at the end of the day. A two-step process will likely catch all of the packages you had before the upgrade, and, if you are paying attention will result in learning some new package management skills.

## Keep track of installed packages, and re-install after the upgrade

Before the upgrade run these commands to save an *R data* file containing a list of your current package library. Feel free to adjust the file names and paths to whatever you like. Keep this file somewhere handy so that *after* the upgrade you can use it.
```{r eval=FALSE}
setwd("~")
packages <- installed.packages()[,"Package"]

save(packages, file="Rpackages")
```

Adjust file names and paths as needed and re-install everything you had prior to the upgrade. It might take a while, great time for a coffee break.
```{r eval=FALSE}
setwd("~")
load("Rpackages")

for (p in setdiff(packages, installed.packages()[,"Package"])) {
  install.packages(p)
}
```


## Troubleshooting
If for some reason scripts or reports aren't running as expected, check the console for errors like this:

`Error in library(aqp) : there is no package called 'aqp'`

Packages can be manually installed from the console like this:

```{r eval=FALSE}
install.packages('aqp', dep=TRUE)
```



# R Studio Configuration

... something about the new options available in the latest version of RStudio, some of which are quite annoying.





